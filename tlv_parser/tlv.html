<html>
	<head>
		<title>TLV parser</title>
	</head>
	<body>
		<h1>TLV parser</h1>
		
		<label for="hexTlv">Enter your hexadecimal TLV string:</label>
		<textarea id="hexTlv"></textarea>
		
		<input type="button" value="parse" id="parse" />
		
		<div id="message"></div>
		<table id="result" style="">
		</table>
		
		<script type="text/javascript" src="../jquery-3.2.1.js"></script>
		<script type="text/javascript">
			$(function() {
				var hexTlv = $("#hexTlv");
				var btn = $("#parse");
				var result = $("#result");
				var message = $("#message");
				
				btn.click(function() {
					var hexString = hexTlv.val();
					result.empty();
					message.empty();
					
					try {
						
						if(hexString) {
						
							result.append($("<tr><th>tag</th><th>length(hex)</th><th>length (dec)</th><th>value (hex)</th><th>value</th></tr>"));
							
							hexTab = hexString.match(/.{1,2}/g);
							result.append($("<tr><td>" + hexTab[0] + hexTab[1] + "</td><td>" + hexTab[2] + "</td><td>" + parseInt(hexTab[2], 16)+ "</td><td>" +  "</td><td>" + "</td></tr>"));

                     for(var i = 3; i < hexTab.length;) {
								var tag = hexTab[i];
								var hexLength = "";
								var length = "";
								var hexValue = "";
								var value = "";
								
								if(tag && tag.length == 2) {
									if( tag[1] === "F" && tag[0]%2 == 1 ) {
										i++;
										tag += hexTab[i];
									}
									
									if(i != 1) {
										i++;
										hexLength = hexTab[i];
										length = parseInt(hexLength, 16);
										i++;
										
										var endIndex = i+length;
										while(i < endIndex) {
											hexValue += hexTab[i];
											value += abcdicDico[parseInt(hexTab[i], 16)];
											i++
										}
										
									}
									
									result.append($("<tr><td>" + tag + "</td><td>" + hexLength + "</td><td>" + length + "</td><td>" + hexValue + "</td><td>" + value + "</td></tr>"));
								} else {
									throw "Error in tag format";
								}
							}
						}
						
						
					} catch(e) {
						message.html(e);
					}
				});
			});
			
			var abcdicDico = {"0":"Null","1":"SOH","2":"STX","3":"ETX","4":"SEL","5":"HT","6":"RNL","7":"Delete","8":"GE","9":"SPS","10":"RPT","11":"VT","12":"Form Feed","13":"Carriage Return","14":"SO","15":"SI","16":"DLE","17":"DC1","18":"DC2","19":"DC3","20":"RES/ENP","21":"New Line","22":"Backspace","23":"POC","24":"CAN","25":"EM","26":"UBS","27":"CU1","28":"IFS","29":"IGS","30":"IRS","31":"ITB/IUS","32":"DS","33":"SOS","34":"FS","35":"Word Underscore","36":"BYP/INP","37":"Line Feed","38":"ETB","39":"Escape","40":"SA","41":"SFE","42":"SM/SW","43":"CSP","44":"MFA","45":"ENQ","46":"ACK","47":"Bell","48":" ","49":" ","50":"SYN","51":"IR","52":"PP","53":"TRN","54":"NBS","55":"EOT","56":"SBS","57":"IT","58":"RFF","59":"CU3","60":"DC4","61":"NAK","62":" ","63":"SUB","64":"Space","65":"RSP","66":"√¢","67":"√§","68":"√ ","69":"√°","70":"√£","71":"√•","72":"√ß","73":"√±","74":"¬¢","75":".","76":"<","77":"(","78":"+","79":"|","80":"&","81":"√©","82":"√™","83":"√´","84":"√®","85":"√≠","86":"√Æ","87":"√Ø","88":"√¨","89":"√ü","90":"!","91":"$","92":"*","93":")","94":";","95":"¬¨","96":"-","97":"/","98":"√Ç","99":"√Ñ","100":"√Ä","101":"√Å","102":"√É","103":"√Ö","104":"√á","105":"√ë","106":"¬¶","107":",","108":"%","109":"_","110":">","111":"?","112":"√∏","113":"√â","114":"√ä","115":"√ã","116":"√à","117":"√ç","118":"√é","119":"√è","120":"√å","121":"`","122":":","123":"#","124":"@","125":"'","126":"=","127":"\"","128":"√ò","129":"a","130":"b","131":"c","132":"d","133":"e","134":"f","135":"g","136":"h","137":"i","138":"¬´","139":"¬ª","140":"√∞","141":"√Ω","142":"√û","143":"¬±","144":"¬∞","145":"j","146":"k","147":"l","148":"m","149":"n","150":"o","151":"p","152":"q","153":"r","154":"¬™","155":"¬∫","156":"√¶","157":"¬∏","158":"√Ü","159":"¬§","160":"¬µ","161":"~","162":"s","163":"t","164":"u","165":"v","166":"w","167":"x","168":"y","169":"z","170":"¬°","171":"¬ø","172":"√ê","173":"√ù","174":"√æ","175":"¬Æ","176":"^","177":"¬£","178":"¬•","179":"¬∑","180":"¬©","181":"¬ß","182":"¬∂","183":"¬º","184":"¬Ω","185":"¬æ","186":"[","187":"]","188":"√§","189":"\"","190":"¬¥","191":"√ó","192":"{","193":"A","194":"B","195":"C","196":"D","197":"E","198":"F","199":"G","200":"H","201":"I","202":"Syllable Hyphen","203":"√¥","204":"√∂","205":"√≤","206":"√≥","207":"√µ","208":"}","209":"J","210":"K","211":"L","212":"M","213":"N","214":"O","215":"P","216":"Q","217":"R","218":"¬π","219":"√ª","220":"√º","221":"√π","222":"√∫","223":"√ø","224":"\\","225":"√∑","226":"S","227":"T","228":"U","229":"V","230":"W","231":"X","232":"Y","233":"Z","234":"¬≤","235":"√î","236":"√ñ","237":"√í","238":"√ì","239":"√ï","240":"0","241":"1","242":"2","243":"3","244":"4","245":"5","246":"6","247":"7","248":"8","249":"9","250":"¬≥","251":"√õ","252":"√ú","253":"√ô","254":"√ö","255":"*"};
			
			
			
			
			
			

			
			
			
			
		</script>
		
	</body>
</html>